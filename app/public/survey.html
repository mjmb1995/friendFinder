<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>FriendFinder</title>
  <!-- jQuery CDN -->
  <script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>

  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

</head>
<body>

  <div class="container">

    <h1>Survey Questions</h1>
    <hr>
    <h2>About You</h2>
    <form>
      <div class="form-group">
        <label for="name">Name (Required)</label>
        <input type="Name" class="form-control" id="name" placeholder="Name">
      </div>
      <div class="form-group">
        <label for="exampleInputPassword1">Link to Photo Image</label>
        <input type="photo" class="form-control" id="photo" placeholder="link to photo image">
      </div>
      <hr>
      <!-- Question 1 -->
      <h2> Question 1</h2>
      <h4>Your mind is always buzzing with unexplored ideas and plans.</h4>
      <div class="btn-group">
        <select name="" class="form-control" id="question1" input type='number'>
          <option value="">Select an option</option>
          <option value=1 input type ='number'>1 (Strongly Disagree)</option>
          <option value=2 input type='number'>2</option>
          <option value=3 input type='number'>3</option>
          <option value=4 input type='number'>4</option>
          <option value=5 input type ='number'>5 (Strongly Agree)</option>
        </select>
      </div>

       <!-- Question 2 -->
      <h2> Question 2</h2>
      <h4>Generally speaking, you rely more on your experience than your imagination.</h4>
      <div class="btn-group">
        <select name="" class="form-control" id="question2" input type='number'>
          <option value="">Select an option</option>
          <option value=1 input type ='number'>1 (Strongly Disagree)</option>
          <option value=2 input type='number'>2</option>
          <option value=3 input type='number'>3</option>
          <option value=4 input type='number'>4</option>
          <option value=5 input type ='number'>5 (Strongly Agree)</option>
        </select>
      </div>

      <!-- Question 3 -->
      <h2> Question 3</h2>
      <h4>You find it easy to stay relaxed and focused even when there is some pressure.</h4>
      <div class="btn-group">
        <select name="" class="form-control" id="question3" input type='number'>
          <option value="">Select an option</option>
          <option value=1 input type ='number'>1 (Strongly Disagree)</option>
          <option value=2 input type='number'>2</option>
          <option value=3 input type='number'>3</option>
          <option value=4 input type='number'>4</option>
          <option value=5 input type ='number'>5 (Strongly Agree)</option>
        </select>
      </div>

      <!-- Question 4 -->
      <h2> Question 4</h2>
      <h4>You rarely do something just out of sheer curiosity.</h4>
      <div class="btn-group">
        <select name="" class="form-control" id="question4" input type='number'>
          <option value="">Select an option</option>
          <option value=1 input type ='number'>1 (Strongly Disagree)</option>
          <option value=2 input type='number'>2</option>
          <option value=3 input type='number'>3</option>
          <option value=4 input type='number'>4</option>
          <option value=5 input type ='number'>5 (Strongly Agree)</option>
        </select>
      </div>

      <!-- Question 5 -->
      <h2> Question 5</h2>
      <h4>You are rarely upset.</h4>
      <div class="btn-group">
        <select name="" class="form-control" id="question5" input type='number'>
          <option value="">Select an option</option>
          <option value=1 input type ='number'>1 (Strongly Disagree)</option>
          <option value=2 input type='number'>2</option>
          <option value=3 input type='number'>3</option>
          <option value=4 input type='number'>4</option>
          <option value=5 input type ='number'>5 (Strongly Agree)</option>
        </select>
      </div>

      <!-- Question 6 -->
      <h2> Question 6</h2>
      <h4>You have a hard time relating to other people.</h4>
      <div class="btn-group">
        <select name="" class="form-control" id="question6" input type='number'>
          <option value="">Select an option</option>
          <option value=1 input type ='number'>1 (Strongly Disagree)</option>
          <option value=2 input type='number'>2</option>
          <option value=3 input type='number'>3</option>
          <option value=4 input type='number'>4</option>
          <option value=5 input type ='number'>5 (Strongly Agree)</option>
        </select>
      </div>

      <!-- Question 7 -->
      <h2> Question 7</h2>
      <h4>It is more important to tell the truth than protecting people's feelings.</h4>
      <div class="btn-group">
        <select name="" class="form-control" id="question7" input type='number'>
          <option value="">Select an option</option>
          <option value=1 input type ='number'>1 (Strongly Disagree)</option>
          <option value=2 input type='number'>2</option>
          <option value=3 input type='number'>3</option>
          <option value=4 input type='number'>4</option>
          <option value=5 input type ='number'>5 (Strongly Agree)</option>
        </select>
      </div>

      <!-- Question 8 -->
      <h2> Question 8</h2>
      <h4>You rarely get carried away by fantasies and ideas.</h4>
      <div class="btn-group">
        <select name="" class="form-control" id="question8" input type='number'>
          <option value="">Select an option</option>
          <option value=1 input type ='number'>1 (Strongly Disagree)</option>
          <option value=2 input type='number'>2</option>
          <option value=3 input type='number'>3</option>
          <option value=4 input type='number'>4</option>
          <option value=5 input type ='number'>5 (Strongly Agree)</option>
        </select>
      </div>

      <!-- Question 9 -->
      <h2> Question 9</h2>
      <h4>You feel more energetic after spending time with a group of people.</h4>
      <div class="btn-group">
        <select name="" class="form-control" id="question9" input type='number'>
          <option value="">Select an option</option>
          <option value=1 input type ='number'>1 (Strongly Disagree)</option>
          <option value=2 input type='number'>2</option>
          <option value=3 input type='number'>3</option>
          <option value=4 input type='number'>4</option>
          <option value=5 input type ='number'>5 (Strongly Agree)</option>
        </select>
      </div>

      <!-- Question 10 -->
      <h2> Question 10</h2>
      <h4>You prefer spending time reading a book than watching movies.</h4>
      <div class="btn-group">
        <select name="" class="form-control" id="question10" input type='number'>
          <option value="">Select an option</option>
          <option value=1 input type ='number'>1 (Strongly Disagree)</option>
          <option value=2 input type='number'>2</option>
          <option value=3 input type='number'>3</option>
          <option value=4 input type='number'>4</option>
          <option value=5 input type ='number'>5 (Strongly Agree)</option>
        </select>
      </div>

      <br>
      <hr>
      <button id="submit" type="submit" class="btn btn-primary btn-lg btn-block" data-toggle="modal" data-target="#myModal">Submit</button>
    </form>

    <!-- Modal -->
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="myModalLabel">You matched on of our members!</h4>
          </div>
          <div class="modal-body container">
              <h1 id="friendResult"></h1>
              <div id="imgDiv"></div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>
    
    

    <footer class="footer">
      <div class="container">
        <p><a href="/api/friends">API Friends List</a> | <a href="https://github.com/mjmb1995/friendFinder">GitHub Repo</a></p>
      </div>
    </footer>

  </div>
</body>
</html>

<!-- BELOW CODE IS CRITICAL. IT HANDLES HOW FORM DATA IS SENT TO OUR SERVER -->
<script type="text/javascript">

  var resetForm = function(){
  $("#name").val('');
      $("#photo").val('');
      $("#question1").val('');
      $("#question2").val('');
      $("#question3").val('');
      $("#question4").val('');
      $("#question5").val('');
      $("#question6").val('');
      $("#question7").val('');
      $("#question8").val('');
      $("#question9").val('');
      $("#question10").val('');
  }

  // In this code below we create the Front-end JavaScript which "POSTS" our form data to our express server.
  // In essence, when the user hits submit, jQuery grabs all of the fields then sends a post request to our api
  // Our api recognizes the route (/api/friends)... and then runs the associated code (found in apiRoutes.js).

  $("#submit").on("click", function(event) {
    event.preventDefault();

    var one = parseInt($('#question1 :selected').val());
    var two = parseInt($('#question2 :selected').val());
    var three = parseInt($('#question3 :selected').val());
    var four = parseInt($('#question4 :selected').val());
    var five = parseInt($('#question5 :selected').val());
    var six = parseInt($('#question6 :selected').val());
    var seven = parseInt($('#question7 :selected').val());
    var eight = parseInt($('#question8 :selected').val());
    var nine = parseInt($('#question9 :selected').val());
    var ten = parseInt($('#question10 :selected').val());


    // Here we grab the form elements
    var newFriend = {
      name: $("#name").val().trim(),
      photo: $("#photo").val().trim(),
      scores: [one, two, three, four, five, six, seven, eight, nine, ten]
    };

    $.ajax({
      type: 'POST',
      data: JSON.stringify(newFriend),
      contentType: 'application/json',
      url: 'api/friends'
    })

    $.ajax({
      url: '/api/friends',
      method: 'GET'
    }).done(function(friendsList){
      var bestMatch = friendsList[1]
      $("#friendResult").text(bestMatch.name);
      $("#imgDiv").empty();
      var img = $('<img id="userPhoto">');
      img.attr('src', bestMatch.photo);
      img.attr({
        src: bestMatch.photo,
        alt: "picture of " + bestMatch.name
      })
      img.appendTo("#imgDiv");
    })
    resetForm();
});
</script>
